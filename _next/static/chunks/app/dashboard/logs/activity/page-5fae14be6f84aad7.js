(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7743],{33284:function(e,t,r){Promise.resolve().then(r.bind(r,25712))},99376:function(e,t,r){"use strict";var a=r(35475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}}),r.o(a,"useServerInsertedHTML")&&r.d(t,{useServerInsertedHTML:function(){return a.useServerInsertedHTML}})},25712:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var a=r(57437),s=r(2265),n=r(80605),l=r(99376),i=r(71594),c=r(24525),o=r(28082),d=r(307),u=r(49089),m=r(89427),g=r(71096),x=r.n(g),h=r(25103),p=r.n(h);function f(e){let{search:t,startDate:r,endDate:l,isUpdate:g,setIsUpdate:h}=e,[f,v]=s.useState([]),[y,j]=s.useState(!1),[b,N]=s.useState([]),[w,S]=s.useState({pageIndex:0,pageSize:10}),[k,C]=s.useState(0),[O,_]=s.useState(0),{data:P}=(0,n.useSession)(),D=(0,i.b7)({data:f,columns:[{accessorKey:"timestamps",header:e=>{let{column:t}=e,r=t.getIsSorted();return(0,a.jsxs)("div",{className:"flex items-center cursor-pointer",onClick:()=>t.toggleSorting(),children:[(0,a.jsx)("span",{children:"Timestamp"}),"asc"===r?(0,a.jsx)(u.h3_,{className:"ml-2"}):"desc"===r?(0,a.jsx)(u.sF,{className:"ml-2"}):(0,a.jsx)(u.roE,{className:"ml-2"})]})},cell:e=>{let{row:t}=e;return(0,a.jsxs)("div",{className:"min-w-[150px]",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:x()(t.original.timestamps).format("DD MMM YYYY")}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:x()(t.original.timestamps).format("HH:mm:ss")})]})}},{accessorKey:"username",header:e=>{let{column:t}=e,r=t.getIsSorted();return(0,a.jsxs)("div",{className:"flex items-center cursor-pointer",onClick:()=>t.toggleSorting(),children:[(0,a.jsx)("span",{children:"User"}),"asc"===r?(0,a.jsx)(u.h3_,{className:"ml-2"}):"desc"===r?(0,a.jsx)(u.sF,{className:"ml-2"}):(0,a.jsx)(u.roE,{className:"ml-2"})]})},cell:e=>{let{row:t}=e,r=(t.original.username||"Unknown").replace(/@metranet\.co\.id$/,"");return(0,a.jsxs)("div",{className:"min-w-[120px]",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white break-words",children:r}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",t.original.user_id]})]})}},{accessorKey:"activity_name",header:e=>{let{column:t}=e,r=t.getIsSorted();return(0,a.jsxs)("div",{className:"flex items-center justify-center cursor-pointer",onClick:()=>t.toggleSorting(),children:[(0,a.jsx)("span",{children:"Activity"}),"asc"===r?(0,a.jsx)(u.h3_,{className:"ml-2"}):"desc"===r?(0,a.jsx)(u.sF,{className:"ml-2"}):(0,a.jsx)(u.roE,{className:"ml-2"})]})},cell:e=>{var t,r,s,n;let{row:l}=e,i=l.original.activity_name,c=(null==i?void 0:null===(n=i.replace(/([A-Z])/g," $1"))||void 0===n?void 0:null===(s=n.replace(/^\s/,""))||void 0===s?void 0:null===(r=s.replace("Create Article","Create"))||void 0===r?void 0:null===(t=r.replace("Update Article","Update"))||void 0===t?void 0:t.replace("Delete Article","Delete"))||i;return(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(o.Vp,{size:"sm",className:"text-center",colorScheme:(null==i?void 0:i.includes("Create"))?"green":(null==i?void 0:i.includes("Update"))?"blue":(null==i?void 0:i.includes("Delete"))?"red":"gray",children:c})})}},{accessorKey:"post_title",header:"Post Title",cell:e=>{let{row:t}=e;return(0,a.jsxs)("div",{className:"max-w-sm",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white break-words whitespace-normal",children:t.original.post_title}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:["by ",t.original.author]})]})}},{accessorKey:"post_status",header:"Status",cell:e=>{let{row:t}=e;return(0,a.jsx)(o.Vp,{size:"sm",colorScheme:"publish"===t.original.post_status?"green":"draft"===t.original.post_status?"yellow":"scheduled"===t.original.post_status?"blue":"gray",children:t.original.post_status})}},{accessorKey:"activity_description",header:"Description",cell:e=>{let{row:t}=e;return(0,a.jsxs)("div",{className:"max-w-sm",children:[(0,a.jsx)("div",{className:"text-sm text-gray-800 dark:text-gray-200 break-words whitespace-normal font-medium",children:t.original.activity_description}),(0,a.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:t.original.log_type})]})}}],getCoreRowModel:(0,c.sC)(),onSortingChange:N,state:{sorting:b},manualSorting:!0,manualPagination:!0}),I=s.useCallback(async()=>{if(null==P?void 0:P.user){j(!0);try{let e=new URLSearchParams({page:(w.pageIndex+1).toString(),limit:w.pageSize.toString()});if(t&&e.append("search",t),r&&e.append("startDate",r.toISOString()),l&&e.append("endDate",l.toISOString()),b.length>0){let t=b[0];e.append("sortField","timestamps"===t.id?"timestamps":t.id),e.append("sortOrder",t.desc?"desc":"asc")}let a=await (0,m.Z)("GET","/api/logs/activity?".concat(e.toString()),{},{});if(200===a.status){let e=a.data;v(e.data||[]),C(e.totalPages||0),_(e.total||0)}else console.error("Failed to fetch activity logs:",a.data),v([])}catch(e){console.error("Error fetching activity logs:",e),v([])}finally{j(!1)}}},[P,t,r,l,w,b]);return s.useEffect(()=>{I()},[I,g]),(0,a.jsxs)("div",{className:"overflow-x-auto",children:[y&&(0,a.jsx)(d.E,{size:"xs",isIndeterminate:!0,colorScheme:"blue",mb:4}),(0,a.jsxs)("div",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:["Showing ",f.length," of ",O," activity logs"]}),(0,a.jsxs)("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[(0,a.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:D.getHeaderGroups().map(e=>(0,a.jsx)("tr",{children:e.headers.map(e=>(0,a.jsx)("th",{className:"px-6 py-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600",children:e.isPlaceholder?null:"function"==typeof e.column.columnDef.header?e.column.columnDef.header(e.getContext()):e.column.columnDef.header},e.id))},e.id))}),(0,a.jsx)("tbody",{children:D.getRowModel().rows.map(e=>(0,a.jsx)("tr",{className:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:e.getVisibleCells().map(e=>(0,a.jsx)("td",{className:"px-6 py-4",children:"function"==typeof e.column.columnDef.cell?e.column.columnDef.cell(e.getContext()):e.getValue()},e.id))},e.id))})]}),0===f.length&&!y&&(0,a.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No activity logs found"}),k>1&&(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)(p(),{breakLabel:"...",nextLabel:"Next",onPageChange:e=>{S(t=>({...t,pageIndex:e.selected}))},pageRangeDisplayed:5,pageCount:k,previousLabel:"Previous",renderOnZeroPageCount:null,className:"flex justify-center items-center space-x-2",pageClassName:"px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",activeClassName:"bg-blue-500 text-white",previousClassName:"px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",nextClassName:"px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",disabledClassName:"opacity-50 cursor-not-allowed",forcePage:w.pageIndex})})]})}var v=r(12125),y=r(10883),j=r(68193),b=r(25810),N=r(85994),w=r.n(N);function S(){let[e,t]=s.useState(0),[r,n]=s.useState(""),[l,i]=s.useState([x()().subtract(7,"day").startOf("day").toDate(),x()().toDate()]),[c,o]=l;return(0,a.jsxs)("div",{className:"px-4 pt-6",children:[(0,a.jsxs)("div",{className:"grid items-center justify-between grid-cols-2",children:[(0,a.jsx)("div",{className:"flex items-center mb-4 lg:mb-0",children:(0,a.jsx)("h3",{className:"mb-2 text-xl font-bold text-gray-900 dark:text-white",children:"Activity Logs"})}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("div",{className:"m-2",children:(0,a.jsx)("div",{className:"max-w-md mx-auto",children:(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)(v.B,{size:"md",children:[(0,a.jsx)(y.I,{pr:"4.5rem",type:"text",placeholder:"search logs...",className:"bg-white dark:bg-gray-700",onKeyDown:e=>"Enter"===e.key&&n(e.target.value)}),(0,a.jsx)(j.x,{children:(0,a.jsx)(b.z,{size:"sm",children:(0,a.jsx)(u.U41,{})})})]})})})})})]}),(0,a.jsxs)("div",{className:"p-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800",children:[(0,a.jsxs)("div",{className:"items-center justify-between lg:flex",children:[(0,a.jsx)("div",{className:"flex items-center mb-4 lg:mb-0"}),(0,a.jsx)("div",{className:"items-center sm:flex",children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center mb-3 space-x-0 space-y-2 md:space-x-2 md:space-y-0",children:[(0,a.jsx)(w(),{className:"bg-white dark:bg-gray-800 !p-[.3rem] !text-sm !w-[200px]",selectsRange:!0,startDate:c,endDate:o,dateFormat:"dd-MM-yyyy",onChange:e=>{i(e)},isClearable:!0}),(0,a.jsx)("div",{className:"w-full md:w-auto",children:(0,a.jsx)(b.z,{colorScheme:"blue",size:"sm",className:"w-full md:w-auto",onClick:()=>t(Math.floor(1e4*Math.random())),children:"Filter"})})]})})})]}),(0,a.jsx)(f,{search:r,startDate:c,endDate:o,isUpdate:e,setIsUpdate:t})]})]})}function k(){var e;let{data:t,status:r}=(0,n.useSession)(),i=(0,l.useRouter)();return(s.useEffect(()=>{var e;if("loading"!==r){if(!t){i.push("/login");return}if((null===(e=t.user)||void 0===e?void 0:e.privilege_id)!==1){i.push("/dashboard");return}}},[t,r,i]),"loading"===r)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Loading..."})}):t&&(null===(e=t.user)||void 0===e?void 0:e.privilege_id)===1?(0,a.jsx)("div",{children:(0,a.jsx)(S,{})}):null}r(21005)},89427:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(83464);async function s(e,t,r,s){try{let n;let l={"User-Agent":"UZone-CMS-Client/1.0 (+https://uzone.id)",...s};return s&&(s["User-Agent"]||s["user-agent"])&&(delete l["User-Agent"],l["User-Agent"]=s["User-Agent"]||s["user-agent"]),n="GET"==e?{validateStatus:()=>!1,method:e,headers:l,url:t,params:r}:{validateStatus:()=>!1,method:e,headers:l,url:t,data:r},await (0,a.Z)(n).catch(e=>e.response)}catch(e){return{data:e,status:500,statusText:"Internal Server Error",headers:{},config:{}}}}},13856:function(e,t,r){"use strict";r.d(t,{J:function(){return o}});var a=r(68973),s=r(9889),n=r(41531),l=r(14096),i=r(57437),c={path:(0,i.jsxs)("g",{stroke:"currentColor",strokeWidth:"1.5",children:[(0,i.jsx)("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),(0,i.jsx)("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),(0,i.jsx)("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})]}),viewBox:"0 0 24 24"},o=(0,a.G)((e,t)=>{let{as:r,viewBox:a,color:o="currentColor",focusable:d=!1,children:u,className:m,__css:g,...x}=e,h=(0,l.cx)("chakra-icon",m),p=(0,s.mq)("Icon",e),f={ref:t,focusable:d,className:h,__css:{w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:o,...g,...p}},v=null!=a?a:c.viewBox;if(r&&"string"!=typeof r)return(0,i.jsx)(n.m.svg,{as:r,...f,...x});let y=null!=u?u:c.path;return(0,i.jsx)(n.m.svg,{verticalAlign:"middle",viewBox:v,...f,...x,children:y})});o.displayName="Icon"},66835:function(e,t,r){"use strict";function a(e){let t=Object.assign({},e);for(let e in t)void 0===t[e]&&delete t[e];return t}r.d(t,{o:function(){return a}})},28082:function(e,t,r){"use strict";r.d(t,{SD:function(){return h},Sn:function(){return g},Vp:function(){return m}});var a=r(13856),s=r(37371),n=r(68973),l=r(9889),i=r(83707),c=r(41531),o=r(57437),[d,u]=(0,s.k)({name:"TagStylesContext",errorMessage:"useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<Tag />\" "}),m=(0,n.G)((e,t)=>{let r=(0,l.jC)("Tag",e),a=(0,i.Lr)(e),s={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...r.container};return(0,o.jsx)(d,{value:r,children:(0,o.jsx)(c.m.span,{ref:t,...a,__css:s})})});m.displayName="Tag";var g=(0,n.G)((e,t)=>{let r=u();return(0,o.jsx)(c.m.span,{ref:t,noOfLines:1,...e,__css:r.label})});g.displayName="TagLabel",(0,n.G)((e,t)=>(0,o.jsx)(a.J,{ref:t,verticalAlign:"top",marginEnd:"0.5rem",...e})).displayName="TagLeftIcon",(0,n.G)((e,t)=>(0,o.jsx)(a.J,{ref:t,verticalAlign:"top",marginStart:"0.5rem",...e})).displayName="TagRightIcon";var x=e=>(0,o.jsx)(a.J,{verticalAlign:"inherit",viewBox:"0 0 512 512",...e,children:(0,o.jsx)("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});x.displayName="TagCloseIcon";var h=(0,n.G)((e,t)=>{let{isDisabled:r,children:a,...s}=e,n={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...u().closeButton};return(0,o.jsx)(c.m.button,{ref:t,"aria-label":"close",...s,type:"button",disabled:r,__css:n,children:a||(0,o.jsx)(x,{})})});h.displayName="TagCloseButton"},46231:function(e,t,r){"use strict";r.d(t,{w_:function(){return d}});var a=r(2265),s={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=a.createContext&&a.createContext(s),l=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){var a,s;a=t,s=r[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(a))in e?Object.defineProperty(e,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[a]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>a.createElement(u,i({attr:o({},e.attr)},t),function e(t){return t&&t.map((t,r)=>a.createElement(t.tag,o({key:r},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var r,{attr:s,size:n,title:c}=e,d=function(e,t){if(null==e)return{};var r,a,s=function(e,t){if(null==e)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(e,l),u=n||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),a.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,d,{className:r,style:o(o({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),c&&a.createElement("title",null,c),e.children)};return void 0!==n?a.createElement(n.Consumer,null,e=>t(e)):t(s)}}},function(e){e.O(0,[7360,7699,1544,9439,2434,3314,4959,9614,2971,2117,1744],function(){return e(e.s=33284)}),_N_E=e.O()}]);